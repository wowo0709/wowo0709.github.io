---
layout: single
title: "[Deep Learning] 컨볼루션 신경망 1"
categories: ['AI', 'DeepLearning']
toc: true
toc_sticky: true
tag: ['컨볼루션', '풀링', '구조']
---

<br>

## 컨볼루션 신경망 (CNN)

`컨볼루션 신경망`(Convolutional Neural Network, CNN)은 동물의 **시각피질**의 구조에서 영감을 받아 만들어진 딥러닝 신경망 모델입니다. 

동물의 시각피질은 **시각 자극**을 **1차 시각피질**을 통해서 처리한 다음, **2차 시각피질**을 경유하여, **3차 시각피질** 등 여러 영역을 통과하여 계층적으로 정보를 처리합니다. 

이는 정보가 **계층적으로 처리**되어 가면서 점차 **추상적인 특징이 추출**되어 시각을 인식하는 것입니다. 

<br>

이와 같이 **컨볼루션 신경망**은 **컨볼루션 연산**과 **풀링 연산**을 사용하는 여러 계층을 사용하여 **이미지 데이터로부터 점차 추상적인 특징을 추출**함으로써 분류/탐지/인식 등을 수행합니다. 

컨볼루션 신경망의 `전반부`는 **이미지 데이터의 특징 추출**을 수행하고, `후반부`는 **추출된 특징을 이용하여 분류**를 수행합니다. 

![image-20211113155642176](https://user-images.githubusercontent.com/70505378/141609752-212c2cb6-0817-4ddb-99fb-20fb059dba1d.png)

<br>

## 컨볼루션

`컨볼루션 연산`은 컨볼루션 계층에서 사용되는 대표적인 연산 중 하나압니다. 

**컨볼루션**은 일정 영역의 값들에 대해 가중치를 적용하여 하나의 값을 만드는 연산입니다. 

![image-20211113155806908](https://user-images.githubusercontent.com/70505378/141609755-72daf39d-0994-4ac7-92fb-b6f766bd38ab.png)

> y11 = w11x11 + w12x12 + w13x13 + w21x21 + w22x22 + w23x23 + w31x31 + w32x32 + w33x33 + w0

<br>

컨볼루션 연산에서 사용하는 `필터(커널)`은 2차원일 수도, 또는 그 이상의 다차원 배열 형태일 수도 있습니다. 이는 입력 데이터의 형상에 따라 달라지며 필터의 형상에 따라 컨볼루션 연산 결과의 배열 형상도 달라집니다. 

👍 **예. 컬러 영상 데이터**

![image-20211113160401890](https://user-images.githubusercontent.com/70505378/141609759-1dca745c-32d3-4da0-93f4-5ec5aab8d7e7.png)

![image-20211113160412020](https://user-images.githubusercontent.com/70505378/141609760-064c8fe9-fb62-46d3-b063-9b625448a2a9.png)

<br>

### 스트라이드와 패딩

컨볼루션 연산에서 사용하는 용어로 `스트라이드`와 `패딩`이라는 것이 있습니다. 

* **스트라이드**: 컨볼루션 연산을 위해 한 번에 필터(커널)를 이동시키는 칸 수
* **패딩**: 컨볼루션 결과의 크기를 조정하기 위해 입력 배열의 둘레를 확장하고 0으로 채우는 연산

![image-20211113160130195](https://user-images.githubusercontent.com/70505378/141609757-d429b55f-bc31-44c0-9a38-6ac91f0b9fb6.png)

<br>

### 특징 지도 (feature map)

컨볼루션 연산에서 사용하는 또 하나의 용어로 `특징 지도(피처 맵)`이라는 것이 있습니다. 

**특징 지도**는 컨볼루션 연산의 결과를 만들어지는 행렬(배열)을 나타냅니다. 

특징 지도의 원소값은 컨볼루션 필터에 표현된 특징을 대응되는 위치에 포함하고 있는 정도를 나타냅니다. 

또한, k개의 컨볼루션 필터를 적용하면 k개의 2차원 특징 지도를 얻을 수 있습니다. 

<br>

<br>

## 풀링

컨볼루션 신경망에서는 컨볼루션 연산 외에도 `풀링 연산`이라는 것을 사용합니다. 

**풀링 연산**이란 일정 크기의 블록을 하나의 대표값으로 대체하는 연산을 말합니다. 

대표적인 풀링 연산에는 **최대 풀링, 평균 풀링, 확률적 풀링**이 있습니다. 

<Br>

### 풀링 연산의 종류

**최대값 풀링(max pooling)**

지정된 블록 내의 원소들 중에서 최대값을 대푯값으로 선택

![image-20211113160903883](https://user-images.githubusercontent.com/70505378/141609761-0f5e1486-90df-4499-8f7e-5ab7704c4f36.png)

**평균값 풀링(average pooling)**

블록 내의 원소들의 평균값을 대푯값으로 사용

![image-20211113160938500](https://user-images.githubusercontent.com/70505378/141609762-c9d59fb0-3a85-4270-963e-03d6cd2bd8fc.png)

**확률적 풀링**

블록 내의 각 원소가 원소값의 크기에 비례하는 선택 확률을 갖도록 하고, 이 확률에 따라 원소 하나를 선택

![image-20211113161019843](https://user-images.githubusercontent.com/70505378/141609764-16ab0cd2-994c-41da-84f3-a809fbbbbd2a.png)

* 학습 시: 확률적 풀링

  ![image-20211113161037066](https://user-images.githubusercontent.com/70505378/141609765-5e7987bb-cfac-4a9e-bb82-8ce9b154ccdf.png)

* 추론 시: 확률적 가중합 사용

  ![image-20211113161101801](https://user-images.githubusercontent.com/70505378/141609770-07d2c17f-f232-4cef-a3f3-c1ac3b2edfa1.png)

<br>

### 풀링 연산의 역할

**풀링 연산**은 컨볼루션 연산 과정에서 만들어지는 **특징 지도들의 크기를 축소**함으로써 다음 단계에서 사용될 **메모리 크기와 계산량을 감소**시키는 역할을 합니다. 

이로 인해 일정 영역 내에 나타나는 특징들을 결합하고, **위치 변화에 강건한 특징**을 선택할 수 있게 됩니다. 

<br>

<br>

## 컨볼루션 신경망의 구조















<br>

<br>

