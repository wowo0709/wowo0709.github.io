---
layout: single
title: "[Knowledge Expression] 불확실한 지식 표현"
categories: ['AI', 'KnowledgeExpression']
toc: true
toc_sticky: true
tag: []
---

<br>

## 불확실성의 원인

**약한 관련성의 지식**

* **약한 인과성**이나 **애매한 연관관계**인 지식의 표현
  * 예: IF(조건)와 THEN(취해야 할 행동) 사이의 연관성의 강도
* <span style="color:blue">**확신도**</span> 사용 표현
* <span style="color:blue">**베이즈 정리**</span> 사용 표현

**부정확한 언어 사용**

* 자연어는 본질적으로 **모호**하고 **부정확**함
  * 예: 자주, 크다, 무겁다 등
* <span style="color:blue">**퍼지 이론**</span> 사용 표현

**불완전하거나 결손된 데이터에 기반한 지식**

* '알려지지 않은 것'으로 간주하고, **근사적인 추론** 진행

**상충되는 지식의 통합**

* **모순**된 견해와 **상충**된 지식의 통합
* 지식 소스 별로 **가중치** 부여

**무작위적 특징에 의한 불확실성**

* 표현 대상 자체가 무작위적 특징을 갖기 때문에 지식이 불확실할 수 밖에 없는 상황
* <span style="color:blue">**확률 그래프 모델**</span> 사용 표현

<br>

<br>

## 확신도

`확신도(certainty factor, cf)`는 **규칙**과 **사실**의 **신뢰정도를 `[-1,1]` 구간의 값**으로 표현(1: 단정적 신뢰, -1: 단정적 불신)한다. 

![image-20211009113333981](https://user-images.githubusercontent.com/70505378/136642602-6e254708-48ee-4fb7-9d5e-51366dedba35.png)

확신도 값에 따라 다음의 의미로 사용된다. 

* -1.0: 절대 아니다. 
* -0.8: 거의 확실히 아니다. 
* -0.6: 아마 아닐 것이다. 
* -0.4: 어쩌면 아닐 것이다. 
* -0.2 ~ 0.2: 모르겠다. 
* 0.4: 어쩌면 그럴 것이다. 
* 0.6: 아마 그럴 것이다. 
* 0.8: 거의 확실하다. 
* 1: 확실하다. 

<br>

### 규칙에 대한 추론 결과의 확신도

주어진 규칙과 사실들에 의해 추론을 하고 나면, **사용한 규칙과 사실들의 확신도를 이용하여 추론의 확신도를 구할 수 있다.**

* <span style="color:blue">**cf(B) = cf(A) * cf(A -> B)**</span>

![image-20211009113755040](https://user-images.githubusercontent.com/70505378/136642673-74be8fd0-04ae-49b4-b2b2-4785849abc18.png)

* <span style="color:blue">**cf(C) = min{ cf(A), cf(B) } * cf(A and B -> C)**</span>

![image-20211009113900912](https://user-images.githubusercontent.com/70505378/136642674-355838d8-5754-4184-b85f-abc341843de7.png)

* <span style="color:blue">**cf(C) = max{ cf(A), cf(B) } * cf(A or B -> C)**</span>

![image-20211009113942258](https://user-images.githubusercontent.com/70505378/136642623-11eedf0d-591f-415d-9231-ea21718f8063.png)

* 예시

  ![image-20211009114046058](https://user-images.githubusercontent.com/70505378/136642624-aa114a23-3831-4164-920e-5b858f64652e.png)

<br>

**여러 규칙**에 의한 **동일 사실 추론**의 확신도 결합은 다음과 같이 이루어진다. 

* <span style="color:blue">**cf1(B) = cf(A) * cf(A -> B)**</span>

![image-20211009114215745](https://user-images.githubusercontent.com/70505378/136642627-6c951ea8-4763-4cb1-a753-50af73dc6e1a.png)

* <span style="color:blue">**cf2(B) = cf(C) * cf(C -> B)**</span>

![image-20211009114245561](https://user-images.githubusercontent.com/70505378/136642630-e5d293cd-14ac-4ccf-ad0f-dca6022c9733.png)

동일한 결과를 내는 두 추론에 의한 확신도를 다음 공식에 의해 결합할 수 있다. 

![image-20211009114404606](https://user-images.githubusercontent.com/70505378/136642720-349e5417-f7dd-4f42-addd-38e2758623dd.png)

<br>

<br>

## 확률기반 불확실성 표현

### 확률

`확률`이란 어떤 사건이 일어날 가능성을 나타내며, 다음과 같은 의미를 가진다. 

* **상대빈도 확률**
  * 빈도주의자 확률이라고도 함. 
  * 전체 실험 횟수 대비 관심 사건의 상대적 빈도. 
* **주관적 확률**
  * 확신 또는 믿음의 정도

<br>

#### 결합 확률

`결합 확률`이란 사건 A와 B가 **동시에 일어날** 확률이다.

 ![image-20211009114722961](https://user-images.githubusercontent.com/70505378/136642721-61452446-add5-47e2-8bab-6fe4e0eb1a87.png)

예를 들어 사건 A가 첫번째 주사위가 짝수인 사건이고, 사건 B가 두번째 주사위가 홀수인 사건일 때 **P(A, B) = 9/36 = 0.25**이다. 

<br>

#### 조건부 확률

`조건부 확률`이란 **사건 B가 일어났을 때 사건 A가 일어날 확률**이다. 

![image-20211009115006714](https://user-images.githubusercontent.com/70505378/136642723-f2ba0203-56cc-4c44-aa45-facd6cf11405.png)

예를 들어 사건 A가 두 주사위의 합이 8인 사건이고, 사건 B가 첫번째 주사위가 3인 사건일 때 **P(A|B) = (1/36)/(6/36) = 1/6**이다. 

<br>

### 베이즈 정리

결합 확률과 조건부 확률을 사용하여 `베이즈 정리`를 도출할 수 있다. 

![image-20211009115212456](https://user-images.githubusercontent.com/70505378/136642724-a59c261c-7cc0-46bd-abe7-96deb6bde143.png)

### 확률을 이용한 규칙의 불확실성 표현

두 명제 A와 B가 `A -> B`와 같은 관계를 가질 때, A를 B의 **충분 조건**이라고 하고 B를 A의 **필요조건**이라고 한다. 

예를 들어, A가 '아버지'를 나타내고 B가 '남자'를 나타낸다면, '아버지'는 '남자'의 충분 조건이 되고 '남자'는 '아버지'의 필요 조건이 된다. 

<br>

그러나 규칙에서는 이와 같이 단정지을 수 없다. 

따라서 어떤 규칙에서 우리는 `충분 가능도`와 `필요 가능도`를 계산할 수 있다. 

**규칙**

![image-20211009115714458](https://user-images.githubusercontent.com/70505378/136642725-5da205f4-6ff0-42bf-bea2-f324cd37fbf7.png)

**충분 가능도**

![image-20211009115730901](https://user-images.githubusercontent.com/70505378/136642760-dd004517-d4fc-439c-be42-2b298cd8869c.png)

**필요 가능도**

![image-20211009115843040](https://user-images.githubusercontent.com/70505378/136642763-6632e9c9-077c-4be8-9862-c516b7842b54.png)

그리고 사실(또는 추론 결과)에 대한 **사전 확률**을 부여한다. 

![image-20211009120142900](https://user-images.githubusercontent.com/70505378/136642764-6557f86f-a99b-4466-a0f0-419ac2d1de0f.png)

이제 위의 정보를 이용하여 **사전 승률 -> 사후 승률 -> 사후 확률**을 구할 수 있다. 

다음은 Rule1의 사후 확률을 구하는 과정이다. 

**사전 승률**

![image-20211009120332488](https://user-images.githubusercontent.com/70505378/136642766-ea9e1eb1-e367-461a-bae4-d4c71e89f058.png)

**사후 승률**

![image-20211009120347711](https://user-images.githubusercontent.com/70505378/136642767-52868869-72da-4fca-9125-4dc8d580583b.png)

**사후 확률**

![image-20211009120404070](https://user-images.githubusercontent.com/70505378/136642796-78373e78-07cc-4823-9b91-d2937e8864d2.png)

<br>

<br>

## 퍼지 이론

### 집합론

자연어의 `단어`는 **집합**의 궁극적인 표현이다. 

* '자동차'는 자동차의 집합
* '자동차 한 대'는 자동차 집합의 원소 하나

**일반 집합**에서 원소는 하나의 집합을 기준으로 둘 중 하나의 상태이다. 

* 원소 x는 집합 X에 **속하거나**, X에 **속하지 않거나** 둘 중 하나
* 집합에 명확한 경계를 긋는다. 
* 집합의 원소에는 1, 원소가 아닌 것에는 0의 소속을 부여하는 이분법적 방식

<br>

그런데, 실제로 개념이나 범주는 항상 이분적이지 않고 모호할 때도 많다. 

이러한 **정도의 문제**를 해결하기 위해 `퍼지 집합`을 사용한다. 

<Br>

### 퍼지 집합

`퍼지 집합`은 원소가 집합에 **어느 정도 속한다**는 것을 수치로 나타낸다. 

이때 **소속 정도**는 [0, 1] 사이의 실수값으로 표현된다. 

아래는 '크다'를 나타내는 소속함수의 예이다. 

![image-20211009120958877](https://user-images.githubusercontent.com/70505378/136642799-ac7f5225-d188-43dc-b0b5-5f144b1dbfd6.png)

<br>

### 소속정도를 사용한 언어항의 표현

퍼지 집합을 사용하면 작다, 평균이다, 크다와 같은 모호한 표현을 다음과 같이 나타낼 수 있다. 

**일반 집합**

![image-20211009121056006](https://user-images.githubusercontent.com/70505378/136642800-96c4312a-0620-4775-97b4-acabf09faa63.png)

**퍼지 집합**

![image-20211009121110035](https://user-images.githubusercontent.com/70505378/136642801-5fc79950-d5ed-4d5c-9011-adc45367d547.png)

<br>

### 언어항을 포함한 지식 표현

퍼지 집합을 사용하여 언어항을 표현하고 추론하는 예시를 살펴보면서 이를 구체화하도록 하자. 

![image-20211009121305448](https://user-images.githubusercontent.com/70505378/136642802-12172e87-f859-4fd7-8c32-4ac98eb6bbe6.png)

<br>

#### 언어항을 표현하는 소속함수

언어항을 표현하기 위해서는 `소속 함수`가 필요하다. 

![image-20211009121317769](https://user-images.githubusercontent.com/70505378/136642803-2c051a7d-ff57-4586-96bb-3167d67932d8.png)

<br>

### 퍼지 추론

`퍼지 추론`이란, **소속 함수**로 표현된 **언어항**을 사용하는 **퍼지 규칙**들의 모음이다. 

이를 통해 언어항의 기호적인 대응을 통한 추론 대신, **수치적인 추론**이 가능하다. 

<br>

현재 예시에서 **service 수치가 3, food 수치가 2**라고 하자. 

그러면 첫번째 경우(IF service = 나쁘다 OR food = 별로이다 THEN tip = 적다)에 대해 아래와 같은 추론 결과를 낼 수 있다. 

![image-20211009121450022](https://user-images.githubusercontent.com/70505378/136642824-dbf104f7-e572-44e5-82c0-94f7e78e4419.png)

그리고 세가지 경우에 대해 모두 추론을 하고 난 후의 결과는 다음과 같다. 

![image-20211009121734241](https://user-images.githubusercontent.com/70505378/136642826-f38e8baf-636a-4021-97eb-1b83beebd5e8.png)

이를 해석하기 위해 최종적으로 `비퍼지화`한다. 

**비퍼지화**란 퍼치 추론의 결과를 실수 값으로 변환하는 것으로, 대표적으로 '무게 중심법'이 있다. 

위 추론 결과에 비퍼지화를 적용하면 최종적으로 8이라는 추론 결과를 낼 수 있다. 

![image-20211009121919616](https://user-images.githubusercontent.com/70505378/136642828-a1f81544-c761-4d86-9885-1df03e60bea4.png)

아래는 이러한 퍼지 추론의 결과를 그래프로 나타낸 것이다. 

![image-20211009121959757](https://user-images.githubusercontent.com/70505378/136642829-4d710f77-7e2d-4aaf-918e-fba3c23d02b2.png)

<br>

<br>

## 확률 그래프 모델

(추후에 추가할 예정입니다.)

### 베이지언 망

### 마르코프 랜덤 필드

### 조건부 랜덤 필드

### 로그-선형 모델

<br>

<br>

## 정리

**불확실한 지식 표현** 방법들 중 확신도, 베이즈 정리, 퍼지 이론을 이용한 표현 및 추론 방법에 대해 살펴보았습니다. 

**확신도**와 **베이즈 정리**는 약한 관련성의 지식을 표현하기 위해 사용됩니다. 

**퍼지 이론**은 부정확한 언어가 사용된 지식을 표현하기 위해 사용됩니다. 
