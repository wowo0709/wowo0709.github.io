---
layout: single
title: "[AITech] 2022ë…„ 1ì›” 19ì¼ í•™ìŠµ ë‚´ìš© ì •ë¦¬"
categories: ['AI', 'AITech']
toc: true
toc_sticky: true
tag: ['ë„˜íŒŒì´','ë²¡í„°/í–‰ë ¬','ê²½ì‚¬í•˜ê°•ë²•']
---



<br>

## ê°•ì˜ ë³µìŠµ ë‚´ìš©

### 1. Numpy

**ì–´ë–»ê²Œ ë²¡í„°ì™€ í–‰ë ¬ì„ ì½”ë“œë¡œ í‘œí˜„í•  ê²ƒì¸ê°€?** â¡ **numpy**

* Numerical Python
* íŒŒì´ì¬ì˜ **ê³ ì„±ëŠ¥ ê³¼í•™ ê³„ì‚°ìš© íŒ¨í‚¤ì§€**
* **Matrixì™€ Vector ê°™ì€ Array ì—°ì‚°ì˜ ì‚¬ì‹¤ ìƒ í‘œì¤€**
* **ì¼ë°˜ Listì— ë¹„í•´ ë¹ ë¥´ê³ , ë©”ëª¨ë¦¬ íš¨ìœ¨ì **
* **ë°˜ë³µë¬¸ ì—†ì´ ë°ì´í„° ë°°ì—´ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ ì§€ì›**
* ì„ í˜•ëŒ€ìˆ˜ì™€ ê´€ë ¨ëœ ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µ
* C, C++, í¬íŠ¸ë€ ë“±ì˜ ì–¸ì–´ì™€ í†µí•© ê°€ëŠ¥

#### ndarray

* ë„˜íŒŒì´ëŠ” np.array í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°°ì—´ì„ ìƒì„±(ndarray)
* ë„˜íŒŒì´ëŠ” **í•˜ë‚˜ì˜ ë°ì´í„° type**ë§Œ ë°°ì—´ì— ë„£ì„ ìˆ˜ ìˆìŒ(**Dynamic typing not supported**)
* Cì˜ Arrayë¥¼ ì‚¬ìš©í•˜ì—¬ ë°°ì—´ì„ ìƒì„±

```python
test_array = np.array([1,4,5,8],float) # ë°°ì—´ ìƒì„± ì‹œ ë°ì´í„° íƒ€ì…ì„ ì§€ì •(int8, float16, float32 ë“±)
print(test_array)
print(type(test_array[3]))
'''
[1. 4. 5. 8.]
<class 'numpy.float64'>
'''
```

* ë„˜íŒŒì´ëŠ” ë°°ì—´ ìƒì„± ì‹œ **ìƒˆë¡œìš´(ë…ë¦½ì ì¸) ë©”ëª¨ë¦¬ ê³µê°„ì— ë”°ë¡œ ìˆ˜ë“¤ì„ ìˆœì„œëŒ€ë¡œ ì €ì¥**

  * ë©”ëª¨ë¦¬ íš¨ìœ¨ì 
  * ì¼ë°˜ ListëŠ” ê°’ì´ ì €ì¥ë˜ì–´ ìˆëŠ” ë©”ëª¨ë¦¬ ì£¼ì†Œê°€ staticí•˜ê²Œ í• ë‹¹ë˜ì–´ ìˆê³ , ê·¸ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ì €ì¥í•˜ëŠ” ë°©ì‹
    * 2ë²ˆì˜ ì°¸ì¡°ê°€ í•„ìš”

  ![image-20220119210842379](https://user-images.githubusercontent.com/70505378/150142997-fb76f5ad-8476-4a3a-acb5-0452d3dac000.png)

```python
# List
a = [1,2,3,4,5]
b = [5,4,3,2,1]
print(a[0] is b[-1])
# Numpy array
a = np.array(a)
b = np.array(b)
print(a[0] is b[-1])
'''
True
False
'''
```

* `ndarray.shape`: numpy arrayì˜ dimension êµ¬ì„±ì„ ë°˜í™˜(í˜•ìƒ)

```python
tensor = [[[1,2,3,8],[1,2,3,8],[1,2,3,8]],
         [[1,2,3,8],[1,2,3,8],[1,2,3,8]],
         [[1,2,3,8],[1,2,3,8],[1,2,3,8]],
         [[1,2,3,8],[1,2,3,8],[1,2,3,8]]]

np.array(tensor,int).shape
# (4, 3, 4)
```

![image-20220119212046981](https://user-images.githubusercontent.com/70505378/150143002-d1c08779-4b78-4cab-bf96-f0922581cea6.png)

* `ndarray.dtype`: numpy arrayì˜ ë°ì´í„° typeì„ ë°˜í™˜

```python
test_array = np.array([1, 4, 5, "8"], float) # String Typeì˜ ë°ì´í„°ë¥¼ ì…ë ¥í•´ë„
print(test_array)
print(type(test_array[3])) # Float Typeìœ¼ë¡œ ìë™ í˜•ë³€í™˜ì„ ì‹¤ì‹œ
print(test_array.dtype) # Array(ë°°ì—´) ì „ì²´ì˜ ë°ì´í„° Typeì„ ë°˜í™˜í•¨
print(test_array.shape) # Array(ë°°ì—´) ì˜ shapeì„ ë°˜í™˜í•¨
'''
[1. 4. 5. 8.]
<class 'numpy.float64'>
float64
(4,)
'''
```

* `ndarray.ndim`: ì°¨ì›ì˜ ê°œìˆ˜
* `ndarray.size`: dataì˜ ì´ ê°œìˆ˜

```python
tensor = [[[1,2,3,8],[1,2,3,8],[1,2,3,8]],
         [[1,2,3,8],[1,2,3,8],[1,2,3,8]],
         [[1,2,3,8],[1,2,3,8],[1,2,3,8]],
         [[1,2,3,8],[1,2,3,8],[1,2,3,8]]]

tensor = np.array(tensor,int)
print(tensor.ndim, tensor.size)
# 3 48
```

* `ndarray.nbytes`: ndarray objectì˜ ë©”ëª¨ë¦¬ í¬ê¸°ë¥¼ ë°˜í™˜

```python
a = np.array([[1,2,3],[4.5,"5","6"]], dtype=np.float32) # 32bits = 4bytes -> 6*4 bytes
b = np.array([[1,2,3],[4.5,"5","6"]], dtype=np.int8)    # 8bits = 1bytes -> 6*1bytes
c = np.array([[1,2,3],[4.5,"5","6"]], dtype=np.float64) # 64bits = 8bytes -> 6*8bytes

print(f"a: {a.nbytes} bytes")
print(f"b: {b.nbytes} bytes")
print(f"c: {c.nbytes} bytes")
'''
a: 24 bytes
b: 6 bytes
c: 48 bytes
'''
```

<br>

#### Handling shape

* `ndarray.reshape(*args)`: Arrayì˜ shapeì˜ í¬ê¸°ë¥¼ ë³€ê²½. elementì˜ ìˆ˜ëŠ” ë™ì¼. 

```python
test_matrix = np.array([[1,2,3,4],[1,2,5,8]],int)
print(test_matrix, test_matrix.shape)

test_matrix = test_matrix.reshape(8,)
print(test_matrix, test_matrix.shape)

'''
[[1 2 3 4]
 [1 2 5 8]] (2, 4)
[1 2 3 4 1 2 5 8] (8,)
'''

print(test_matrix.reshape(-1,2),test_matrix.reshape(-1,2).shape)
# print(test_matrix.reshape(4,2),test_matrix.reshape(4,2).shape)
'''
[[1 2]
 [3 4]
 [1 2]
 [5 8]] (4, 2)
'''
```

* `ndarray.flatten()`: ë‹¤ì°¨ì› arrayë¥¼ 1ì°¨ì› arrayë¡œ ë³€í™˜

```python
test_matrix = np.array([[1,2,3,4],[1,2,5,8]],int)
print(test_matrix, test_matrix.shape)
print(test_matrix.flatten(),test_matrix.flatten().shape)
'''
[[1 2 3 4]
 [1 2 5 8]] (2, 4)
[1 2 3 4 1 2 5 8] (8,)
'''
```

<br>

#### Indexing & Slicing

* Listì™€ ë‹¬ë¦¬ ì´ì°¨ì› ë°°ì—´ì—ì„œ **[0,0] í‘œê¸°ë²•**ì„ ì§€ì›
  * ì•ì€ row, ë’¤ëŠ” column

```python
test_example = np.array([[1,2,3],[4.5,5,6]],int)
print(test_example[0][0],test_example[0,0])

test_example[0,0] = 12
print(test_example)
'''
1 1
[[12  2  3]
 [ 4  5  6]]
'''
```

* Listì™€ ë‹¬ë¦¬ **í–‰ê³¼ ì—´ ë¶€ë¶„ì„ ë‚˜ëˆ ì„œ slicing**ì´ ê°€ëŠ¥í•¨
  * matrixì˜ ë¶€ë¶„ ì§‘í•©ì„ ì¶”ì¶œí•  ë•Œ ìœ ìš©

```python
a = np.array([[1,2,3,4,5],[6,7,8,9,10]],int)
print(a)
print(a[:,2:])
print(a[1,1:3])
print(a[1:3])
'''
[[ 1  2  3  4  5]
 [ 6  7  8  9 10]]
[[ 3  4  5]
 [ 8  9 10]]
[7 8]
[[ 6  7  8  9 10]]
'''
# stepì„ ì§€ì •í•  ìˆ˜ ìˆìŒ
a = np.array([[1,2,3,4,5],[6,7,8,9,10],[11,12,13,14,15]],int)
print(a)
print(a[:,::2])
print(a[::2,::3])
'''
[[ 1  2  3  4  5]
 [ 6  7  8  9 10]
 [11 12 13 14 15]]
[[ 1  3  5]
 [ 6  8 10]
 [11 13 15]]
[[ 1  4]
 [11 14]]
'''
```

![image-20220119214020429](https://user-images.githubusercontent.com/70505378/150143004-dc2423a9-80de-429d-9786-9f801251a8d3.png)

<br>

#### Creation function

* `np.arange(start, end, step)`: arrayì˜ ë²”ìœ„ë¥¼ ì§€ì •í•˜ì—¬, ê°’ì˜ listë¥¼ ìƒì„±í•˜ëŠ” ëª…ë ¹ì–´

```python
print(np.arange(10))
print(np.arange(0,5,0.5))
print(np.arange(10).reshape(2,5)) # reshapeì™€ í•¨ê»˜ ìì£¼ ì‚¬ìš©
'''
[0 1 2 3 4 5 6 7 8 9]
[0.  0.5 1.  1.5 2.  2.5 3.  3.5 4.  4.5]
[[0 1 2 3 4]
 [5 6 7 8 9]]
'''
```

* `np.zeros(shape,dtype), np.ones(shape,dtype), np.empty(shape,dtype)`
  * ê°ê° 0ìœ¼ë¡œ, 1ë¡œ, í–˜ë‹¹ë˜ì§€ ì•Šì€ ë©”ëª¨ë¦¬ë¡œ ì±„ì›Œì§„ í–‰ë ¬ì„ ë°˜í™˜
* `np.zeros_like(ndarray,dtype), np.ones_like(ndarray,dtype), np.empty(ndarray,dtype)`
  * ê°ê° ì¸ìë¡œ ì „ë‹¬ë°›ì€ ndarrayì™€ ê°™ì€ í˜•ìƒì¸ 0, 1, í• ë‹¹ë˜ì§€ ì•Šì€ ë©”ëª¨ë¦¬ë¡œ ì±„ì›Œì§„ í–‰ë ¬ì„ ë°˜í™˜
* `np.identity(n, dtype)`: ë‹¨ìœ„ í–‰ë ¬ ìƒì„±
* `np.eye(N, M, k, dtype)`: ëŒ€ê°ì„ ì´ 1ì¸ í–‰ë ¬, kê°’ì˜ ì‹œì‘ index ë³€ê²½ ê°€ëŠ¥

```python
print(np.eye(3))
print(np.eye(3,5,k=2))
'''
[[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
[[0. 0. 1. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 1.]]
'''
```

* `np.diag(ndarray, k)`: ëŒ€ê° í–‰ë ¬ì˜ ê°’ì„ ì¶”ì¶œ, kê°’ì˜ ì‹œì‘ ì¸ë±ìŠ¤ ë³€ê²½ ê°€ëŠ¥

```python
matrix = np.arange(9).reshape(3,3)
print(matrix)
print(np.diag(matrix))
print(np.diag(matrix, k=1))
'''
[[0 1 2]
 [3 4 5]
 [6 7 8]]
[0 4 8]
[1 5]
'''
```

* `np.random.uniform(from, to, n), np.random.normal(from, to, n)`: ë°ì´í„° ë¶„í¬ì— ë”°ë¥¸ samplingìœ¼ë¡œ arrayë¥¼ ìƒì„±

```python
print(np.random.uniform(0,1,10).reshape(2,5))
print(np.random.normal(0,1,10).reshape(2,5))
'''
[[0.35006331 0.24951611 0.49920446 0.61727984 0.82651679]
 [0.04549254 0.17509728 0.52278906 0.12011707 0.7854978 ]]
[[-0.07886817  1.05551477 -0.09244039  0.32329219 -1.3036152 ]
 [-0.22816616  0.25514229  1.3512013   1.59589969  0.0897062 ]]
'''
```

<br>

#### Operation functions

* `ndarray.sum(axis)`: axisë¥¼ ê¸°ì¤€ìœ¼ë¡œ ndarrayì˜ element ê°„ì˜ í•©ì„ êµ¬í•¨

```python
third_order_tensor = np.array([[[1,2,3,4],[5,6,7,8],[9,10,11,12]],
                                 [[1,2,3,4],[5,6,7,8],[9,10,11,12]],
                                 [[1,2,3,4],[5,6,7,8],[9,10,11,12]]])

print(third_order_tensor.sum(axis=2))
print(third_order_tensor.sum(axis=1))
print(third_order_tensor.sum(axis=0))
'''
[[10 26 42]
 [10 26 42]
 [10 26 42]]
[[15 18 21 24]
 [15 18 21 24]
 [15 18 21 24]]
[[ 3  6  9 12]
 [15 18 21 24]
 [27 30 33 36]]
'''
```

![image-20220119215349932](https://user-images.githubusercontent.com/70505378/150143010-0d2049e5-51f0-45e2-8f6f-dc954ad0f17b.png)

* `ndarray.mean(axis), ndarray.std(axis)`: ndarrayì˜ element ê°„ í‰ê·  ë˜ëŠ” í‘œì¤€ í¸ì°¨
* ê·¸ ì™¸ì—ë„ ë‹¤ì–‘í•œ ìˆ˜í•™ ì—°ì‚°ìë¥¼ ì œê³µ
  * `np.exp(ndarray), np.sqrt(ndarray), np.sin(ndarray), np.sinh(ndarray), np.arcsin(ndarray)...`

##### **Concatenate**

* `np.vstack((ndarray1,ndarray2)), hstack((ndarray1, ndarray2))`

```python
a = np.array([1,2,3])
b = np.array([2,3,4])
print(np.vstack((a,b)))

a = np.array([[1],[2],[3]])
b = np.array([[2],[3],[4]])
print(np.hstack((a,b)))
'''
[[1 2 3]
 [2 3 4]]
[[1 2]
 [2 3]
 [3 4]]
'''
```

![image-20220119220423961](https://user-images.githubusercontent.com/70505378/150143012-e3ed8111-6f18-468d-bce9-fac315e7b40d.png)

* `np.concatenate((ndarray1, ndarray2), axis)`

```python
a = np.array([1,2,3])
b = np.array([2,3,4])
print(np.concatenate((a,b), axis=0))

a = np.array([[1,2],[3,4]])
b = np.array([[5],[6]])
print(np.concatenate((a,b), axis=1))
'''
[1 2 3 2 3 4]
[[1 2 5]
 [3 4 6]]
'''
```

<br>

#### Array operations

* numpyëŠ” array ê°„ì˜ ê¸°ë³¸ì ì¸ ì‚¬ì¹™ ì—°ì‚°ì„ ì§€ì›í•¨

```python
test_a = np.array([[1,2,3],[4,5,6]], float)
print(test_a+test_a)
print(test_a-test_a)
print(test_a*test_a) # element wise multiplication(Hadamard multiplication)
print(test_a.dot(test_a.T)) # matrix multiplication
print(test_a.transpose(), test_a.T) # transpose
'''
[[ 2.  4.  6.]
 [ 8. 10. 12.]]
[[0. 0. 0.]
 [0. 0. 0.]]
[[ 1.  4.  9.]
 [16. 25. 36.]]
[[14. 32.]
 [32. 77.]]
[[1. 4.]
 [2. 5.]
 [3. 6.]] 
[[1. 4.]
 [2. 5.]
 [3. 6.]]
'''
```

##### **Broadcasting**

* Shapeì´ ë‹¤ë¥¸ ë°°ì—´ ê°„ ì—°ì‚°ì„ ì§€ì›

![image-20220119221237272](https://user-images.githubusercontent.com/70505378/150143014-3793beb7-010d-4c1b-937f-2806bbaf8a56.png)

```python
test_matrix = np.array([[1,2,3],[4,5,6]],float)
scalar = 3

print(test_matrix + scalar)
print(test_matrix - scalar)
print(test_matrix * scalar)
print(test_matrix / scalar)
print(test_matrix // scalar)
print(test_matrix ** scalar)
'''
[[4. 5. 6.]
 [7. 8. 9.]]
[[-2. -1.  0.]
 [ 1.  2.  3.]]
[[ 3.  6.  9.]
 [12. 15. 18.]]
[[0.33333333 0.66666667 1.        ]
 [1.33333333 1.66666667 2.        ]]
[[0. 0. 1.]
 [1. 1. 2.]]
[[  1.   8.  27.]
 [ 64. 125. 216.]]
'''
```

* Scalar ì™¸ì—ë„ vector - matrix ê°„ ì—°ì‚°ë„ ì§€ì›

![image-20220119221509193](https://user-images.githubusercontent.com/70505378/150143017-d5ba9046-43c2-4886-9452-0f9cc456f10c.png)

##### Numpy performance

* ì¼ë°˜ì ìœ¼ë¡œ ì†ë„ëŠ” **for loop < list comprehension < numpy** ìˆœ
* 100,000,000 ë²ˆì˜ loopì´ ëŒ ë•Œ, ì•½ 4ë°° ì´ìƒì˜ ì„±ëŠ¥ ì°¨ì´ë¥¼ ë³´ì„
* NumpyëŠ” Cë¡œ êµ¬í˜„ë˜ì–´ ìˆì–´, ì„±ëŠ¥ì„ í™•ë³´í•˜ëŠ” ëŒ€ì‹  íŒŒì´ì¬ì˜ ê°€ì¥ í° íŠ¹ì§•ì¸ dynamic typingì„ í¬ê¸°í•¨
* ëŒ€ìš©ëŸ‰ ê³„ì‚°ì—ì„œëŠ” ê°€ì¥ í”íˆ ì‚¬ìš©ë¨
* Concatenateì²˜ëŸ¼ ê³„ì‚°ì´ ì•„ë‹Œ, í• ë‹¹ì—ì„œëŠ” ì—°ì‚° ì†ë„ì˜ ì´ì ì´ ì—†ìŒ

<br>

#### Comparisons

* `np.any(condition), np.all(condition)`: Arrayì˜ ë°ì´í„° ì „ë¶€ í˜¹ì¸ ì¼ë¶€ê°€ ì¡°ê±´ì— ë§Œì¡± ì—¬ë¶€ ë°˜í™˜

```python
a = np.arange(10)
print(a)
print(a>5)
print(np.any(a>5))
print(np.all(a>5))
'''
[0 1 2 3 4 5 6 7 8 9]
[False False False False False False  True  True  True  True]
True
False
'''
```

* `np.logical_and(bool_ndarray1, bool_ndarray2), np.logical_or(bool_ndarray1, bool_ndarray2), np.logical_not(bool_ndarray)`

```python
a = np.array([1,3,0], float)
print(a > 0, a < 3)
print(np.logical_and(a > 0, a < 3))
print(np.logical_or(a > 0, a < 3))
print(np.logical_not(a > 0))
'''
[ True  True False] [ True False  True]
[ True False False]
[ True  True  True]
[False False  True]
'''
```

* `np.where(condition, TRUE, FALSE)`
  * ì¸ìë¡œ conditionë§Œ ì „ë‹¬ ì‹œ Trueì¸ ê°’ì˜ ì¸ë±ìŠ¤ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜
  * ì¸ìë¡œ condition, TRUE, FALSE ëª¨ë‘ ì „ë‹¬ ì‹œ Trueì¸ ê°’ì€ TRUEë¡œ, Falseì¸ ê°’ì€ FALSEë¡œ ì¹˜í™˜ëœ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜

```python
a = np.array([1,3,0], float)
print(a > 0)
print(np.where(a > 0))
print(np.where(a > 0,3,2))
'''
[ True  True False]
(array([0, 1], dtype=int64),)
[3 3 2]
'''
```

* `np.isnan(ndarray), np.isfinite(ndarray)`

```python
a = np.array([1,np.NaN,np.Inf], float)
print(np.isnan(a))
print(np.isfinite(a))
'''
[False  True False]
[ True False False]
'''
```

<br>

#### argmax, argmin, argsort

* `np.argmax(ndarray, axis), np.argmin(ndarray, axis)`: array ë‚´ ìµœëŒ“ê°’ ë˜ëŠ” ìµœì†Ÿê°’ì˜ indexë¥¼ ë°˜í™˜
* `np.argsort(ndarray, axis)`: ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í–ˆì„ ë•Œ ê¸°ì¡´ array ì›ì†Œì˜ indexë¥¼ ë°˜í™˜

```python
a = np.array([[1,2,4,7], [9,88,6,45], [9,76,3,4]])
print(a)
print(np.argmax(a,axis=1))
print(np.argmin(a, axis=0))
'''
[[ 1  2  4  7]
 [ 9 88  6 45]
 [ 9 76  3  4]]
[3 1 1]
[0 0 2 2]
[[0 0 2 2]
 [1 2 0 0]
 [2 1 1 1]]
'''
```

<br>

#### Boolean & Fancy indexing

**Boolean index**

* íŠ¹ì • ì¡°ê±´ì— ë”°ë¥¸ ê°’ì„ ë§¤ì—´ í˜•íƒœë¡œ ì¶”ì¶œ
* Comparison operation í•¨ìˆ˜ë“¤ë„ ëª¨ë‘ ì‚¬ìš© ê°€ëŠ¥

```python
test_array = np.array([1,4,0,2,3,8,9,7], float)
condition = test_array > 3
print(condition)
print(test_array[condition]) # ì¡°ê±´ì´ Trueì¸ indexì˜ elementë§Œ ì¶”ì¶œ
'''
[False  True False False False  True  True  True]
[4. 8. 9. 7.]
'''
```

**Fancy index**

* numpyëŠ” arrayë¥¼ index valueë¡œ ì‚¬ìš©í•´ì„œ ê°’ ì¶”ì¶œ
* `ndarray.take(ndarray)`: fancy index(bracket index)ê³¼ ê°™ì€ íš¨ê³¼

```python
a = np.array([2,4,6,8], float)
b = np.array([0,0,1,3,2,1], int)
print(a[b]) # bracket index, b ë°°ì—´ì˜ ê°’ì„ indexë¡œ í•˜ì—¬ aì˜ ê°’ë“¤ì„ ì¶”ì¶œ
print(a.take(b)) # take í•¨ìˆ˜: bracket indexì™€ ê°™ì€ íš¨ê³¼
'''
[2. 2. 4. 8. 6. 4.]
[2. 2. 4. 8. 6. 4.]
'''
```

* matrix í˜•íƒœì˜ ë°ì´í„°ë„ ê°€ëŠ¥

```python
a = np.array([[1,4],[9,16]], float)
b = np.array([0,0,1,1,0], int)
c = np.array([0,1,1,1,1], int)
print(a[b,c])
# [ 1.  4. 16. 16.  4.]
```

<br>

#### Numpy data i/o

* text typeì˜ ë°ì´í„°ë¥¼ ì½ê³ , ì €ì¥í•˜ëŠ” ê¸°ëŠ¥

```python
# íŒŒì¼ ì €ì¥
np.save("npy_test_object", arr=a_int_3)
# íŒŒì¼ í˜¸ì¶œ
a_test = np.load(file="npy_test_object.npy")
```



<br>

### 2. ë²¡í„°

* **ë²¡í„°**ëŠ” ìˆ«ìë¥¼ ì›ì†Œë¡œ ê°€ì§€ëŠ” ë¦¬ìŠ¤íŠ¸ ë˜ëŠ” ë°°ì—´ì´ë‹¤. 
  
  * **ë²¡í„°ì˜ ì°¨ì›**ì€ ë²¡í„°ê°€ ê°€ì§„ ì›ì†Œì˜ ê°œìˆ˜ì´ë‹¤. 
  
* **ë²¡í„°**ëŠ” nì°¨ì› ê³µê°„ì—ì„œ í•œ ì ì„ ë‚˜íƒ€ë‚¸ë‹¤. 
  * ë²¡í„°ì— ìˆ«ìë¥¼ ê³±í•´ì£¼ë©´ ê¸¸ì´ë§Œ ë³€í•œë‹¤. (ìŠ¤ì¹¼ë¼ê³±)
  * ë²¡í„°ëŠ” ê°™ì€ ëª¨ì–‘ì„ ê°€ì§€ë©´ ë§ì…ˆ, ëº„ì…ˆ, ì„±ë¶„ê³±(Hadamard product)ì„ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤. 
    * ë²¡í„° ë§ì…ˆì€ ë‹¤ë¥¸ ë²¡í„°ë¡œë¶€í„° ìƒëŒ€ì  ìœ„ì¹˜ ì´ë™ì„ í‘œí˜„í•©ë‹ˆë‹¤. 
    * ë²¡í„° ëº„ì…ˆì€ ë²¡í„°ì˜ ë°©í–¥ì„ ë’¤ì§‘ì€ ë§ì…ˆì…ë‹ˆë‹¤. 
  
  ```python
  import numpy as np
  
  x = np.array([1,7,2])
  y = np.array([5,2,1])
  
  # ë²¡í„° ë§ì…ˆ
  print(x+y)
  # ë²¡í„° ëº„ì…ˆ
  print(x-y)
  # ë²¡í„° ë‚´ì 
  print(x*y)
  '''
  [6 9 3]
  [-4  5  1]
  [ 5 14  2]
  '''
  ```

* **ë²¡í„°ì˜ ë…¸ë¦„**ì€ **ì›ì ì—ì„œë¶€í„°ì˜ ê±°ë¦¬**ë¥¼ ë§í•©ë‹ˆë‹¤. 

  ![ë…¸ë¦„(norm)](https://t1.daumcdn.net/cfile/tistory/99D721445BD00C6E1A)

  ```python
  def l1_norm(x):
      x_norm = np.abs(x)
      x_norm = np.sum(x_norm)
      return x_norm
  
  def l2_norm(x):
      x_norm = x*x
      x_norm = np.sum(x_norm)
      x_norm = np.sqrt(x_norm)
      return x_norm
  
  x = np.array([1,2,3])
  print(f"l1 norm: {l1_norm(x)}")
  print(f"l2 norm: {l2_norm(x)}")
  '''
  l1 norm: 6
  l2 norm: 3.7416573867739413
  '''
  ```

* ì„œë¡œ ë‹¤ë¥¸ ë…¸ë¦„ì´ ì¤‘ìš”í•œ ì´ìœ 

  * ë…¸ë¦„ì˜ ì¢…ë¥˜ì— ë”°ë¼ **ê¸°í•˜í•™ì  ì„±ì§ˆ**ì´ ë‹¬ë¼ì§„ë‹¤. 
  * ë¨¸ì‹ ëŸ¬ë‹ì—ì„  ê° ì„±ì§ˆë“¤ì´ í•„ìš”í•  ëŒ€ê°€ ìˆìœ¼ë¯€ë¡œ ë‘˜ ë‹¤ ì‚¬ìš©í•œë‹¤. 

  ![image-20220119112430894](https://user-images.githubusercontent.com/70505378/150055194-34fd93f3-c1e7-445e-bae5-10ab8320cb10.png)

  * L1, L2 ë…¸ë¦„ì„ ì´ìš©í•´ **ë‘ ë²¡í„° ì‚¬ì´ì˜ ê±°ë¦¬**ë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤. 
  * L2 ë…¸ë¦„ì„ ì´ìš©í•´ **ë‘ ë²¡í„° ì‚¬ì´ ê°ë„**ë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤. 

  ```python
  def angle(x,y):
      v = np.inner(x,y) / (l2_norm(x)*l2_norm(y))
      theta = np.arccos(v)
      return theta # Pi ê¸°ì¤€ í‘œì‹œ
  
  x, y = np.array([1,10,3]), np.array([-1,-10,-3])
  print(angle(x,y))
  # 3.141592653589793
  ```

* **ë‚´ì **ì€ **ì •ì‚¬ì˜ëœ ë²¡í„°ì˜ ê¸¸ì´**ì™€ ê´€ë ¨ ìˆë‹¤. 

  * ë‚´ì ì€ ë‘ ë²¡í„°ì˜ **ìœ ì‚¬ë„**ë¥¼ ì¸¡ì •í•˜ëŠ” ë° ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤. 

  ![image-20220119113026170](https://user-images.githubusercontent.com/70505378/150055199-3e4817d2-36ed-48a9-8ece-35b3a388a8a4.png)

<br>

### 3. í–‰ë ¬

* **í–‰ë ¬**ì€ ë²¡í„°ë¥¼ ì›ì†Œë¡œ ê°€ì§€ëŠ” **2ì°¨ì› ë°°ì—´**ì´ë‹¤. 

  * í–‰ë ¬ì€ **í–‰**ê³¼ **ì—´**ì´ë¼ëŠ” ì¸ë±ìŠ¤ë¥¼ ê°€ì§„ë‹¤. 

  ![image-20220119113221006](https://user-images.githubusercontent.com/70505378/150055203-94431aca-0f80-443a-9bfe-bd3284897dac.png)

  * **ì „ì¹˜ í–‰ë ¬**ì€ í–‰ê³¼ ì—´ì˜ ì¸ë±ìŠ¤ê°€ ë°”ë€ í–‰ë ¬ì´ë‹¤. 

  ![image-20220119113259537](https://user-images.githubusercontent.com/70505378/150055206-fde116e1-e729-4adc-badd-c85201a60274.png)

  * í–‰ë ¬ë¼ë¦¬ ê°™ì€ ëª¨ì–‘ì„ ê°€ì§€ë©´ ë§ì…ˆ, ëº„ì…ˆ, ì„±ë¶„ê³±, ìŠ¤ì¹¼ë¼ê³±ì„ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤. 
  * **í–‰ë ¬ ê³±ì…ˆ**ì€ **ië²ˆì§¸ í–‰ë²¡í„°ì™€ jë²ˆì¬ ì—´ë²¡í„° ì‚¬ì´ì˜ ë‚´ì **ì„ ê³„ì‚°í•˜ê³ , **í–‰ë ¬ ë‚´ì **ì€ **ië²ˆì§¸ í–‰ë²¡í„°ì™€ jë²ˆì§¸ í–‰ë²¡í„° ì‚¬ì´ì˜ ë‚´ì (XY<sup>T</sup>**ì„ ê³„ì‚°í•œë‹¤. 
    * ìˆ˜í•™ì—ì„œ ë§í•˜ëŠ” ë‚´ì ê³¼ëŠ” ë‹¤ë¥´ë¯€ë¡œ ì£¼ì˜!

  ```python
  X = np.array([[1,-2,3],
                [7,5,0],
                [-2,-1,2]])
  Y = np.array([[0,1,10],
                [1,-1,7],
                [-2,1,0]])
  
  # í–‰ë ¬ê³±
  print(X @ Y)
  # í–‰ë ¬ ë‚´ì 
  print(np.inner(X,Y)) # = X @ Y.T
  '''
  [[ -8   6  -4]
   [  5   2 105]
   [ -5   1 -27]]
  [[28 24 -4]
   [ 5  2 -9]
   [19 13  3]]
  '''
  ```

  

* **í–‰ë ¬ì„ ì´í•´í•˜ëŠ” ë°©ë²• 1**

  * ë²¡í„°ê°€ ê³µê°„ì—ì„œ í•œ ì ì„ ë‚˜íƒ€ë‚¸ë‹¤ë©´, í–‰ë ¬ì„ **ì—¬ëŸ¬ ì ë“¤**ì„ ë‚˜íƒ€ë‚¸ë‹¤. 
  * í–‰ë ¬ì˜ í–‰ë²¡í„° xiëŠ” ië²ˆì§¸ ë°ì´í„°ë¥¼ ì˜ë¯¸í•œë‹¤. 
  * í–‰ë ¬ì˜ xijëŠ” ië²ˆì§¸ ë°ì´í„°ì˜ jë²ˆì§¸ ë³€ìˆ˜ì˜ ê°’ì„ ë§í•œë‹¤. 

   

* **í–‰ë ¬ì„ ì´í•´í•˜ëŠ” ë°©ë²• 2**

  * í–‰ë ¬ì€ **ë²¡í„° ê³µê°„ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì—°ì‚°ì**ë¡œ ì´í•´í•œë‹¤. 
  * í–‰ë ¬ ê³±ì„ í†µí•´ ë²¡í„°ë¥¼ **ë‹¤ë¥¸ ì°¨ì›ì˜ ê³µê°„**ìœ¼ë¡œ ë³´ë‚¼ ìˆ˜ ìˆë‹¤. 
  * í–‰ë ¬ ê³±ì„ í†µí•´ **íŒ¨í„´ì„ ì¶”ì¶œ**í•  ìˆ˜ë„ ìˆê³ , **ë°ì´í„°ë¥¼ ì••ì¶•**í•  ìˆ˜ë„ ìˆë‹¤. 
    * ëª¨ë“  ì„ í˜•ë³€í™˜ì€ í–‰ë ¬ê³±ìœ¼ë¡œ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤!

  ![image-20220119114208634](https://user-images.githubusercontent.com/70505378/150055207-b575bca8-e772-4339-bf0f-5ac106ff97be.png)

  * ì—­í–‰ë ¬ ì´í•´í•˜ê¸°

    * ì–´ë–¤ í–‰ë ¬ Aì˜ ì—°ì‚°ì„ ê±°ê¾¸ë¡œ ë˜ëŒë¦¬ëŠ” í–‰ë ¬ì„ **ì—­í–‰ë ¬**ì´ë¼ ë¶€ë¥´ê³  A<sup>-1</sup>ë¼ í‘œê¸°í•œë‹¤. (AA<sup>-1</sup> = A<sup>-1</sup>A = I)

      ![image-20220119114654455](https://user-images.githubusercontent.com/70505378/150055214-792166a7-7145-4145-b5c2-f70a3590f1de.png)

      ![image-20220119114636254](https://user-images.githubusercontent.com/70505378/150055212-79f4a05c-5c8d-4b73-b20b-97c6dc9bc695.png)

      

    * ì—­í–‰ë ¬ì€ **í–‰ê³¼ ì—´ ìˆ«ìê°€ ê°™ê³  í–‰ë ¬ì‹ì´ 0ì´ ì•„ë‹Œ ê²½ìš°**ì—ë§Œ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤. 

    * ë§Œì¼ ì—­í–‰ë ¬ì„ ê³„ì‚°í•  ìˆ˜ ì—†ë‹¤ë©´ **ìœ ì‚¬ ì—­í–‰ë ¬** ë˜ëŠ” **ë¬´ì–´-íœë¡œì¦ˆ ì—­í–‰ë ¬** A<sup>+</sup>ì„ ì´ìš©í•œë‹¤. 

      ![image-20220119114552134](https://user-images.githubusercontent.com/70505378/150055211-3e39b636-a6f3-4af6-ab75-ff475b0b37a2.png)

      ![image-20220119114535231](https://user-images.githubusercontent.com/70505378/150055210-7aa5dd1b-d297-4648-8564-466deb0d19c1.png)

    ```python
    X = np.array([[1,-2,3],
                  [7,5,0],
                  [-2,-1,2]])
    
    # ì—­í–‰ë ¬
    print(np.linalg.inv(X))
    print(X @ np.linalg.inv(X))
    # ìœ ì‚¬ ì—­í–‰ë ¬
    print(np.linalg.pinv(X))
    print(X @ np.linalg.pinv(X))
    '''
    [[ 0.21276596  0.0212766  -0.31914894]
     [-0.29787234  0.17021277  0.44680851]
     [ 0.06382979  0.10638298  0.40425532]]
    [[ 1.00000000e+00 -1.38777878e-17  0.00000000e+00]
     [-2.22044605e-16  1.00000000e+00 -5.55111512e-17]
     [-2.77555756e-17  0.00000000e+00  1.00000000e+00]]
    [[ 0.21276596  0.0212766  -0.31914894]
     [-0.29787234  0.17021277  0.44680851]
     [ 0.06382979  0.10638298  0.40425532]]
    [[ 1.00000000e+00 -2.08166817e-16  5.55111512e-16]
     [-1.66533454e-16  1.00000000e+00  3.33066907e-16]
     [ 1.66533454e-16  8.32667268e-17  1.00000000e+00]]
    '''
    ```

**ì‘ìš©**

* ì—°ë¦½ ë°©ì •ì‹ í’€ê¸°

  * `np.linalg.pinv`ë¥¼ ì´ìš©í•˜ë©´ ì—°ë¦½ë°©ì •ì‹ì˜ í•´ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤. 

  ![image-20220119115006710](https://user-images.githubusercontent.com/70505378/150055217-5a13cccc-ce7e-49b1-9d4b-d69e60d4f494.png)

  * `np.linalg.pinv`ë¥¼ ì´ìš©í•˜ë©´ ë°ì´í„°ë¥¼ ì„ í˜• ëª¨ë¸ë¡œ í•´ì„í•˜ëŠ” **ì„ í˜• íšŒê·€ì‹**ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤. 

  ![image-20220119115141877](https://user-images.githubusercontent.com/70505378/150055221-bff6b7cf-f2bb-4b15-8d61-6c43c88dc21c.png)

  ```python
  # Scikit Learnì„ í™œìš©í•œ íšŒê·€ë¶„ì„
  from sklearn.linear_model import LinearRegression
  model = LinearRegression()
  model.fit(X, y)
  y_test = model.predict(x_test)
  
  # Moore-Penrose ì—­í–‰ë ¬
  X_ = np.array([np.append(x,[1]) for x in X])
  beta = np.linalg.pinv(X_) @ y
  t_test = np.append(x,[1]) @ beta
  ```

  

<br>

### 4. ê²½ì‚¬í•˜ê°•ë²• (ìˆœí•œë§›)

**ë¯¸ë¶„**

* **ë¯¸ë¶„**ì€ **ë³€ìˆ˜ì˜ ì›€ì§ì„ì— ë”°ë¥¸ í•¨ìˆ˜ê°’ì˜ ë³€í™”ë¥¼ ì¸¡ì •í•˜ê¸° ìœ„í•œ ë„êµ¬**ë¡œ ìµœì í™”ì—ì„œ ì œì¼ ë§ì´ ì‚¬ìš©í•˜ëŠ” ê¸°ë²•ì´ë‹¤. 

  ```python
  import sympy as sym
  from sympy.abc import x
  
  sym.diff(sym.poly(x**2 + 2*x + 3),x)
  # Poly(2ğ‘¥+2,ğ‘¥,ğ‘‘ğ‘œğ‘šğ‘ğ‘–ğ‘›=â„¤)
  ```

* ë¯¸ë¶„ì€ í•¨ìˆ˜ fì˜ ì£¼ì–´ì§„ ì  (x, f(x))ì—ì„œì˜ **ì ‘ì„ ì˜ ê¸°ìš¸ê¸°**ë¥¼ êµ¬í•œë‹¤. 

  * í•œ ì ì—ì„œ ì ‘ì„ ì˜ ê¸°ìš¸ê¸°ë¥¼ ì•Œë©´ ì–´ëŠ ë°©í–¥ìœ¼ë¡œ ì ì„ ì›€ì§ì—¬ì•¼ í•¨ìˆ˜ê°’ì´ ì¦ê°€/ê°ì†Œí•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤. 
  * **ë¯¸ë¶„ê°’ì„ ë”í•˜ë©´ 'ê²½ì‚¬ìƒìŠ¹ë²•'**ì´ë¼ í•˜ë©°, í•¨ìˆ˜ì˜ **ê·¹ëŒ“ê°’**ì˜ ìœ„ì¹˜ë¥¼ êµ¬í•  ë•Œ ì‚¬ìš©í•œë‹¤. (ëª©ì í•¨ìˆ˜ ìµœëŒ€í™”)

  ![image-20220119134819687](https://user-images.githubusercontent.com/70505378/150077661-2655dee2-debc-4cdc-bcff-dc71318ad39d.png)

  * **ë¯¸ë¶„ê°’ì„ ë¹¼ë©´ 'ê²½ì‚¬í•˜ê°•ë²•'**ì´ë¼ í•˜ë©° í•¨ìˆ˜ì˜ **ê·¹ì†Ÿê°’**ì˜ ìœ„ì¹˜ë¥¼ êµ¬í•  ë•Œ ì‚¬ìš©í•œë‹¤. (ëª©ì í•¨ìˆ˜ ìµœì†Œí™”)

  ![image-20220119134943930](https://user-images.githubusercontent.com/70505378/150077664-9418387e-8c0c-4ee8-930a-b8373ca1198e.png)

  * **ê·¹ê°’ì—ì„œëŠ” ë¯¸ë¶„ê°’ì´ 0**ì´ë¯€ë¡œ ë” ì´ìƒ ì—…ë°ì´íŠ¸ê°€ ì¼ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤. 

* ê²½ì‚¬í•˜ê°•ë²•: ì•Œê³ ë¦¬ì¦˜

```python
# pseudo code
# Input: gradient, init, lr, eps, Output: var
var = init
grad = gradient(var)
while(bas(grad) > eps): # ì¢…ë£Œ ì¡°ê±´
    var = var - lr * grad # x ê°’ ê°±ì‹ 
    grad = gradient(var)
```

```python
# python code
def func(val):
    fun = sym.poly(x**2 + 2*x + 3)
    return fun.subs(x, val), fun

def func_gradient(fun, val):
    _, function = fun(val)
    diff = sym.diff(function, x)
    return diff.subs(x, val), diff

def gradient_descent(fun, init_point, lr_rate = 1e-2, epsilon = 1e-5):
    cnt = 0
    val = init_point
    diff, _ = func_gradient(fun, init_point)
    while np.abs(diff) > epsilon:
        val = val - lr_rate*diff
        diff, _ = func_gradient(fun, val)
        cnt += 1
        
    print(f"í•¨ìˆ˜: {fun(val)[1]}, ì—°ì‚°íšŸìˆ˜: {cnt}, ìµœì†Œì : ({val},{fun(val)[0]})")
    
    
gradient_descent(fun=func, init_point=np.random.uniform(-2,2))
# í•¨ìˆ˜: Poly(x**2 + 2*x + 3, x, domain='ZZ'), ì—°ì‚°íšŸìˆ˜: 632, ìµœì†Œì : (-0.999995083760464,2.00000000002417)
```

**ë³€ìˆ˜ê°€ ë²¡í„°ë¼ë©´?**

* ë²¡í„°ê°€ ì…ë ¥ì¸ ë‹¤ë³€ìˆ˜ í•¨ìˆ˜ì˜ ê²½ìš° **í¸ë¯¸ë¶„**ì„ ì‚¬ìš©í•œë‹¤. 

  ```python
  import sympy as sym
  from sympy.abc import x, y
  
  sym.diff(sym.poly(x**2 + 2*x*y + 3) + sym.cos(x + 2*y), x)
  # 2ğ‘¥+2ğ‘¦âˆ’sin(ğ‘¥+2ğ‘¦)
  ```

* ê° ë³€ìˆ˜ë³„ë¡œ í¸ë¯¸ë¶„ì„ ê³„ì‚°í•œ **ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°**ë¥¼ ì´ìš©í•˜ì—¬ ê²½ì‚¬í•˜ê°•/ê²½ì‚¬ìƒìŠ¹ë²•ì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. 

  ![image-20220119135959609](https://user-images.githubusercontent.com/70505378/150077665-bb495cc7-cd9a-4f9a-8ed5-fa356d8916c5.png)

* ê²½ì‚¬í•˜ê°•ë²•: ì•Œê³ ë¦¬ì¦˜

```python
# Pseudo code
# Input: gradient, init, lr, eps, Output: var

var = init
grad = gradient(var)
while(norm(grad) > eps): # ë²¡í„°ì˜ ê²½ìš° ì ˆëŒ“ê°’ ëŒ€ì‹  ë…¸ë¦„(norm)ì„ ê³„ì‚°í•´ì„œ ì¢…ë£Œì¡°ê±´ ì„¤ì •
    var = var - lr * grad
    grad = gradient(var)
```

```python
# python code
def eval_(fun, val):
    val_x, val_y = val
    fun_eval = fun.subs(y, val_y)
    return fun_eval

def func_multi(val):
    x_, y_ = val
    func = sym.poly(x**2 + 2*y**2)
    return eval_(func, [x_, y_]), func

def func_gradient(fun, val):
    x_, y_ = val
    _, function = fun(val)
    diff_x = sym.diff(function, x)
    diff_y = sym.diff(function, y)
    grad_vec = np.array([eval_(diff_x, [x_, y_]), eval_(diff_y, [x_, y_])], dtype=float)
    return grad_vec, [diff_x, diff_y]

def gradient_descent(fun, init_point, lr_rate=1e-2, epsilon=1e-5):
    cnt = 0
    val = init_point
    diff, _ = func_gradient(fun, val)
    while np.linalg.norm(diff) > epsilon:
        val = val - lr_rate*diff
        diff, _ = func_gradient(fun, val)
        cnt += 1
        
    print(f"í•¨ìˆ˜: {fun(val)[1]}, ì—°ì‚°íšŸìˆ˜: {cnt}, ìµœì†Œì : ({val},{fun(val)[0]})")
    
    
pt = [np.random.uniform(-2,2), np.random.uniform(-2,2)]
gradient_descent(fun=func_multi, init_point=pt)
```



<br>

### 4. ê²½ì‚¬í•˜ê°•ë²• (ë§¤ìš´ë§›)

**ê²½ì‚¬í•˜ê°•ë²•ì„ ì´ìš©í•œ ì„ í˜• íšŒê·€**

ì•ì„œ **ì—­í–‰ë ¬ì„ ì´ìš©í•˜ë©´ ì„ í˜•íšŒê·€ëª¨ë¸ì„ êµ¬í•  ìˆ˜ ìˆë‹¤**ê³  í–ˆë‹¤. 

**ê²½ì‚¬ í•˜ê°•ë²•**ì„ ì´ìš©í•˜ë©´ ì—­í–‰ë ¬ì„ ì´ìš©í•˜ì§€ ì•Šê³  ì ì ˆí•œ ì„ í˜• ëª¨ë¸ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤. 

* ì„ í˜•íšŒê·€ì˜ ëª©ì ì‹ì€ \|\|y âˆ’ XÎ²\|\|<sub>2</sub>ì´ê³  **ì´ë¥¼ ìµœì†Œí™”í•˜ëŠ” beta**ë¥¼ ì°¾ì•„ì•¼ í•˜ë¯€ë¡œ ì´ì— ëŒ€í•œ ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ë¥¼ êµ¬í•œë‹¤. 

  * ê³„ì‚°ì˜ í¸ì˜ë¥¼ ìœ„í•´ ëª©ì ì‹ì„ ì œê³±í•œ í•­ì„ ëª©ì ì‹ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤. 

  ![image-20220119141342983](https://user-images.githubusercontent.com/70505378/150077669-4d96609d-c9d5-49e7-b522-0e897bf3c9b5.png)

  * ì´ì œ ëª©ì ì‹ì„ ìµœì†Œí™”í•˜ëŠ” betaë¥¼ êµ¬í•˜ëŠ” ê²½ì‚¬í•˜ê°•ë²• ì•Œê³ ë¦¬ì¦˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. 

  ![image-20220119141422702](https://user-images.githubusercontent.com/70505378/150077673-26e78fbc-0c86-4219-8216-586e450f312d.png)

* ê²½ì‚¬í•˜ê°•ë²• ê¸°ë°˜ ì„ í˜•íšŒê·€ ì•Œê³ ë¦¬ì¦˜

  * ì¢…ë£Œ ì¡°ê±´ì„ ì¼ì • íšŸìˆ˜ë¡œ ì„¤ì •í•  ê²½ìš° **í•™ìŠµ íšŸìˆ˜**ì™€ **í•™ìŠµë¥ **ì´ ì¤‘ìš”í•œ parameterê°€ ëœë‹¤. ë‘ ê°’ì— ë”°ë¼ ì ì ˆí•œ ëª¨ë¸ì„ ì°¾ì„ ìˆ˜ë„, ì°¾ì§€ ëª» í• ìˆ˜ë„ ìˆë‹¤. 

```python
# Pseudo code
# Input: X, y, lr, T, Output: beta

for t in range(T): # ì¢…ë£Œì¡°ê±´ì„ ì¼ì • í•™ìŠµ íšŸìˆ˜ë¡œ ì„¤ì •
    error = y - X * beta 
    grad = -transpose(X) @ error # ë¯¸ë¶„ì‹
    beta = beta - lr * grad # beta ì—…ë°ì´íŠ¸
```

```python
# Python code
X = np.array([[1,1], [1,2], [2,2], [2,3]])
y = np.dot(X, np.array([1,2])) + 3

beta_gd = [10.1, 15.1, -6.5] # [1,2,3]ì´ ì •ë‹µ
X_ = np.array([np.append(x,[1]) for x in X]) # intercept í•­ ì¶”ê°€

for t in range(5000):
    error = y - X_ @ beta_gd
    # error = error / np.linalg.norm(error)
    grad = -np.transpose(X_) @ error
    beta_gd = beta_gd - 0.01*grad
    
print(beta_gd)
# [1.00000367 1.99999949 2.99999516]
```

**í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•(Stochastic Gradient Descent, SGD)**

* ì´ë¡ ì ìœ¼ë¡œ ê²½ì‚¬ í•˜ê°•ë²•ì€ **ë¯¸ë¶„ê°€ëŠ¥í•˜ê³  ë³¼ë¡í•œ í•¨ìˆ˜**ì— ëŒ€í•´ì„œëŠ” **ì ì ˆí•œ í•™ìŠµë¥ ê³¼ í•™ìŠµ íšŸìˆ˜ í•˜ì— ìˆ˜ë ´ì´ ë³´ì¥**ëœë‹¤. 

  * íŠ¹íˆ ì„ í˜• íšŒê·€ì˜ ê²½ìš° ëª©ì ì‹ì´ betaì— ëŒ€í•´ ë³¼ë¡í•˜ê¸° ë•Œë¬¸ì— ìˆ˜ë ´ì´ ë³´ì¥ëœë‹¤. 

* í•˜ì§€ë§Œ **ë¹„ì„ í˜•íšŒê·€** ë¬¸ì œì˜ ê²½ìš° ëª©ì ì‹ì´ ë³¼ë¡í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ **ìˆ˜ë ´ì´ í•­ìƒ ë³´ì¥ë˜ì§€ëŠ” ì•ŠëŠ”ë‹¤.**

  * íŠ¹íˆ ë”¥ëŸ¬ë‹ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ëª©ì ì‹ì€ ëŒ€ë¶€ë¶„ ë³¼ë¡ í•¨ìˆ˜ê°€ ì•„ë‹ˆë‹¤. 

* **í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•**

  * í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•ì€ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ì„œ ì—…ë°ì´íŠ¸ í•˜ëŠ” ëŒ€ì‹ , **ë°ì´í„° í•œ ê°œ ë˜ëŠ” ì¼ë¶€(ë¯¸ë‹ˆ ë°°ì¹˜)ë¥¼ í™œìš©í•˜ì—¬ ì—…ë°ì´íŠ¸í•œë‹¤.**

  * SGDëŠ” ë°ì´í„°ì˜ ì¼ë¶€ë¥¼ ê°€ì§€ê³  íŒŒë¼ë¯¸í„°ë¥¼ ì—…ë°ì´íŠ¸ í•˜ê¸° ë•Œë¬¸ì— ì—°ì‚°ìì›ì„ ì¢€ ë” íš¨ìœ¨ì ìœ¼ë¡œ í™œìš©í•˜ëŠ” ë° ë„ì›€ì´ ëœë‹¤. 

  * ë¯¸ë‹ˆ ë°°ì¹˜ëŠ” í™•ë¥ ì ìœ¼ë¡œ ì„ íƒí•˜ë¯€ë¡œ **ëª©ì ì‹ ëª¨ì–‘ì´ ë°”ë€Œê²Œ ëœë‹¤.**

    * ë”°ë¼ì„œ ìµœì í™” ê³¼ì •ì—ì„œ local minimumì— ë¹ ì ¸ì„œ grad = 0ì´ ë˜ë”ë¼ë„ íƒˆì¶œ í•  ìˆ˜ ìˆë‹¤. 

    ![image-20220119142539708](https://user-images.githubusercontent.com/70505378/150077675-d4f05fd0-8386-45ef-ba2a-0d1e2d6f8224.png)

  * SGDëŠ” ë³¼ë¡ì´ ì•„ë‹Œ ëª©ì ì‹ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥í•˜ë¯€ë¡œ ê²½ì‚¬í•˜ê°•ë²•ë³´ë‹¤ **ë¨¸ì‹ ëŸ¬ë‹ í•™ìŠµì— ë” íš¨ìœ¨ì **ì´ë‹¤. 

  ![image-20220119142854277](https://user-images.githubusercontent.com/70505378/150077677-bb528f36-87ce-453d-8eb5-088bb450824b.png)







<br>

<br>

## í”¼ì–´ì„¸ì…˜ ì •ë¦¬

ì˜¤ëŠ˜ í”¼ì–´ì„¸ì…˜ì—ì„œëŠ” ê°•ì˜ ë‚´ìš©ì—ì„œ ë‹¤ë£¬ L1, L2 normì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ í•˜ì˜€ë‹¤. 

ê°•ì˜ ìƒì—ì„œ ë‘ ë…¸ë¦„ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ê¸°í•˜í•™ì  íŠ¹ì„±ì´ ë‹¤ë¥´ê³ , ê²½ìš°ì— ë”°ë¼ ì„œë¡œ ë‹¤ë¥¸ ê²ƒì´ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤ê³  í•˜ì˜€ëŠ”ë° ê·¸ì— ëŒ€í•œ ìì„¸í•œ ìš©ë¡€ëŠ” ì†Œê°œí•´ì£¼ì§€ëŠ” ì•Šìœ¼ì…¨ë‹¤. 

ê°€ì¤‘ì¹˜ ê·œì œ ì‹œ Lassoì—ì„œëŠ” L1 normì„, Ridgeì—ì„œëŠ” L2 normì„ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì„ ê³µìœ í–ˆìœ¼ë©°, Lassoì˜ ê²½ìš° ê°€ì¤‘ì¹˜ë¥¼ ì „ì²´ì ìœ¼ë¡œ ì¤„ì´ëŠ” íš¨ê³¼ê°€ ìˆì–´ ì˜í–¥ì„ ì ê²Œ ì£¼ëŠ” ê°€ì¤‘ì¹˜ê°€ ë¨¼ì € ì†Œë©¸ë˜ì–´ feature selectionì˜ íš¨ê³¼ê°€ ìˆê³  Ridgeì˜ ê²½ìš° ì˜í–¥ì´ í° ê°€ì¤‘ì¹˜ê°€ ë” ë¹ ë¥´ê²Œ ì¤„ì–´ë“¤ì–´ overfittingì„ ë°©ì§€í•˜ëŠ” íš¨ê³¼ê°€ ìˆë‹¤ëŠ” ê²ƒì„ ë‹¤ì‹œ í•œ ë²ˆ remindí–ˆë‹¤. 

ë˜í•œ ê³¼ì œ ì¤‘ ìˆì—ˆë˜ ë¬¸ìì—´ ì²˜ë¦¬ì— ìˆì–´ ì• ë§¤í•œ ë¶€ë¶„ì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ì—ˆê³ , ì• ë§¤í•¨ì´ ìˆë‹¤ëŠ” ê²ƒì—ëŠ” ë™ì˜ë¥¼ í•˜ì˜€ì§€ë§Œ ë‹¤ë“¤ Testcaseë¥¼ í†µê³¼í•¨ì— ìˆì–´ì„œëŠ” í° ì–´ë ¤ì›€ì„ ê²ªì§€ ì•Šì•„ ì •ë¦¬í•˜ê³  ë„˜ì–´ê°ˆ ìˆ˜ ìˆì—ˆë‹¤. 

ë˜í•œ í‰ì†Œì™€ ê°™ì´ ë‹¤ìŒ ë‚  ê°•ì˜ì™€ í€´ì¦ˆì— ëŒ€í•œ ì§„ë„ë¥¼ ì¡°ì ˆí•˜ê³  ë§ˆì³¤ë‹¤. 

<br>

<br>

## ê³¼ì œ ìˆ˜í–‰ ê³¼ì •/ê²°ê³¼ë¬¼



<br>

<br>

## í•™ìŠµ íšŒê³ 

3ì¼ì°¨ì— ì ‘ì–´ë“¤ì—ˆê³ , ì¡°ê¸ˆì´ì§€ë§Œ ì ì  ì´ íŒ¨í„´ì— ìµìˆ™í•´ì§€ê³  ìˆëŠ” ë“¯í•œ ëŠë‚Œì´ ë“ ë‹¤. 

ê°•ì˜ë¥¼ ë“£ê³  ë‹¤ë¥¸ ìº í¼ ë¶„ë“¤ê³¼ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ëŠ” ê²ƒì´ ì¬ë°Œê³ , ì•ìœ¼ë¡œë„ ì´ì™€ ê°™ì´ ìˆœì¡°ë¡­ê²Œ ìº í”„ê°€ ì§„í–‰ë˜ì—ˆìœ¼ë©´ í•˜ëŠ” ë°”ëŒì´ë‹¤. 

ë˜í•œ ì²˜ìŒìœ¼ë¡œ ë©˜í† ë§ íƒ€ì„ì´ ìˆì—ˆëŠ”ë°, ë©˜í†  ë¶„ê»˜ì„œ ì¢‹ì€ ë§ì”€ë“¤ì„ ë§ì´ í•´ì£¼ì‹œê³  ì§ˆë¬¸ì— ëŒ€í•œ ë‹µë³€ë„ ì„±ì‹¬ì„±ì˜ê» í•´ì£¼ì…”ì„œ ì •ë§ ë§ì€ ë„ì›€ì´ ë˜ì—ˆë‹¤. ì•ìœ¼ë¡œë„ ë§ì€ ë„ì›€ì„ ì–»ì„ ìˆ˜ ìˆì—ˆìœ¼ë©´ ì¢‹ê² ë‹¤. 
